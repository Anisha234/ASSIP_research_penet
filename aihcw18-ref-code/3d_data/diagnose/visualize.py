"""
visualize.py
	inputs a model and data and produces visualizations of the prediction
	should include cams, lime
"""
import sys
import os
from pathlib import Path
sys.path.append(str(Path(__file__).absolute().parent.parent))

import dicom
import numpy as np
import re
from collections import defaultdict
import csv
from PIL import Image
import argparse
#from utils import *
#from model.models import ResNet152, DenseNet121, Simple3D,SeqRNNResNet18, Resnet183D, model_dict
#from data.loader import load_data
#from evaluate.predict import predict
import pickle
import shutil
import matplotlib
import matplotlib.pyplot as plt

def get_parser():
    parser = argparse.ArgumentParser()
    # Predict Parameters
    parser.add_argument('--model_paths', type=str, nargs='+', required=True)
    parser.add_argument('--dataset', type=str, default="valid")
    return parser

def view_scan(datadir, filename):
	filepath = datadir + '/' + filename
	print(filepath)
	scan = np.load(filepath)
	img_slice = scan[0]
	plt.
	plt.imshow(img_slice, cmap='gray')
	

def visualize_clusters(cluster_dir, num_clusters, start,end):
	cluster_info_file = cluster_dir + '/cluster_{}/range_{}_{}/unlocalized/cluster_dict'.format(num_clusters, start,end)
	#datadir = '/deep/group/aihc-bootcamp-winter2018/nborus/ct_chest_pe/preprocessed_images_New4ChestData/width700_level100/'
	datadir = '/deep/group/aihc-bootcamp-winter2018/medical-imaging/ct_chest_pe/New4ChestData/images/'
	range_dir = cluster_dir + '/cluster_{}/range_{}_{}/unlocalized/'.format(num_clusters, start,end)
	store_parent_dir = range_dir + 'images/'

	print("cluster info file: ", cluster_info_file)
	print("Data dir: ", datadir)
	print("range dir: ", range_dir)
	print("Store parent dir: ", store_parent_dir)
	with open(cluster_info_file, 'rb') as fp:
		cluster_info = pickle.load(fp)

	so_far = 0
	non_existent_scans = set()
	for cluster in cluster_info:
		members = cluster_info[cluster]
		desc_dir = store_parent_dir + str(cluster)
		if not os.path.exists(desc_dir):
			os.makedirs(desc_dir)
		print("*"*60)
		print("Cluster: {}, Members: {}".format(cluster, members))
		for i, member in enumerate(members):
			slice_index = int(member[:member.find('_')])
			filename = member[member.find('_')+1:]
			src_file = datadir + filename
			print ("Cluster {}, Member {}, filename {} ".format(cluster, i, member))
			scan = np.load(src_file)
			print(scan.shape)
			img_slice = scan[slice_index]
			plt.imsave(desc_dir + '/' + member[:-3] + 'png', img_slice, cmap='gray')



	'''
	for cluster in cluster_info:
		members = cluster_info[cluster]
		desc_dir = store_parent_dir + str(cluster)
		if not os.path.exists(desc_dir):
			os.makedirs(desc_dir)
		print("*"*60)
		print("Cluster: {}, Members: {}".format(cluster, members))
		for i, member in enumerate(members):
			slice_index = member[:member.find('_')]
			filename = member[member.find('_')+1:]
			
			src_file = datadir + filename + '/' + "{}.png".format(slice_index)
			if not os.path.exists(src_file):
				print("Path doesn't exist")
				non_existent_scans.add(filename)
				continue

			#print("{} --> {}, {} --> {}".format(member, slice_index, filename, src_file))
			shutil.copy(src_file, desc_dir + '/' + member)
			print("Cluster {}, Member {}, filename {}".format(cluster, i, member))
	

	with open(range_dir + "non_existent_scans", 'wb') as fp:
		pickle.dump(non_existent_scans, fp)
	'''



import os
def avg_num_slices(data_dir, csv_filepath):
	dataset = os.path.basename(csv_filepath) 
	num_slices_info_file = csv_filepath[:-4] + '_num_slices'
	#num_slices_info_file = dataset[:-4] + '_num_slices'
	num_slices_info = {}
	with open(csv_filepath) as f:
		content = f.readlines()
	filenames = [(x.strip()).split(',')[0] for x in content]
	num_slices = []
	for index, filename in enumerate(filenames):
		np_array_file = data_dir + filename + '.npy'
		#print(np_array_file, os.path.exists(np_array_file))

		if os.path.exists(np_array_file):
			np_array = np.load(np_array_file)
			num_slices_info[filename + '.npy'] = len(np_array)
			print(index, "--->", len(np_array))
			num_slices.append(len(np_array))


	print(num_slices_info_file)
	print(num_slices_info)

	with open(num_slices_info_file, 'wb') as fp:
		pickle.dump(num_slices_info, fp)

	print("avg # of slices: ", 1.0*sum(num_slices)/len(num_slices))


def avg_num_slices_without_outliers(num_slices_info_file):
	invalid_files_less_10_combinedNew4ChestData_lt_800 = ['91_10_1_1.npy', '604_8_1.npy', '441_8_1.npy', '1413_200_1_1.npy', '524_7_1_1.npy', '753_7_1_1.npy', '1914_10_1_1.npy', '1287_2_1.npy', '556_200_1_1.npy', '145_9_1_1.npy', '1984_200_1_1.npy', '1277_200_1.npy', '658_10_1_1.npy', '29_2_1_1.npy', '72_2_1.npy', '1199_5_1_1.npy', '2005_200_1_1.npy', '646_2_1.npy', '570_200_1_1.npy', '351_4_1_1.npy', '1681_10_1_1.npy', '595_10_1.npy', '826_4_1_1.npy', '639_10_1_1.npy', '1150_3_1.npy', '1716_2_1_1.npy', '1689_8_1_1.npy', '622_200_1_1.npy', '1227_2_1.npy', '326_8_1.npy', '614_202_1_1.npy', '635_200_1.npy', '779_19_1_1.npy', '162_10_1.npy', '886_2_1.npy', '714_7_1_1.npy', '397_11_1_1.npy', '1397_200_1_1.npy', '1230_200_1.npy', '223_2_1_1.npy', '1249_12_1_1.npy', '111_2_1_1.npy', '931_5_1_1.npy', '1398_9_1_1.npy', '1120_200_1.npy', '194_10_1_1.npy', '1021_8_1.npy', '939_10_1.npy', '174_8_1.npy', '199_203_1.npy', '179_200_1.npy', '1686_6_1_1.npy', '287_6_1.npy', '1403_11_1_1.npy', '353_3_1.npy', '1008_2_1.npy', '1487_6_1_1.npy', '1118_2_1_1.npy', '992_5_1.npy', '1746_10_1_1.npy', '1809_200_1_1.npy', '75_10_1.npy', '1174_9_1_1.npy', '1758_10_1_1.npy', '1811_4_1_1.npy', '715_10_1_1.npy', '908_2_1_1.npy', '1143_10_1.npy', '933_7_1_1.npy', '923_257_1.npy', '1963_10_1_1.npy', '214_201_1.npy', '1018_200_1.npy', '457_2_1_1.npy', '475_200_1_1.npy', '1043_200_1.npy', '110_200_1_1.npy', '723_200_1_1.npy', '1265_17_1_1.npy', '804_5_1_1.npy', '1007_9_1_1.npy', '1151_10_1_1.npy', '1258_200_1.npy', '308_2_1_1.npy', '236_7_1_1.npy', '1487_5_1_1.npy', '1339_10_1_1.npy', '565_5_1_1.npy', '71_2_1.npy', '761_10_1_1.npy', '301_3_1.npy', '317_8_1.npy', '180_10_1_1.npy', '1701_10_1_1.npy', '849_10_1.npy', '1128_2_1_1.npy', '517_200_1_1.npy', '54_9_1.npy', '1053_8_1_1.npy', '1236_10_1.npy', '1203_2_1.npy', '302_2_1_1.npy', '1156_200_1.npy', '969_4_1_1.npy', '1254_10_1_1.npy', '1794_12_1_1.npy', '228_9_1_1.npy', '907_9_1.npy', '520_10_1.npy', '212_10_1.npy', '998_2_1_1.npy', '1432_2_1_1.npy', '621_8_1_1.npy', '1587_201_1_1.npy', '1943_8_1_1.npy', '1603_8_1_1.npy', '369_8_1_1.npy', '646_2_1_1.npy', '167_200_1_1.npy', '953_4_1_1.npy', '1640_10_1_1.npy', '138_10_1.npy', '435_200_1_1.npy', '494_10_1_1.npy', '443_10_1_1.npy', '552_200_1_1.npy', '1743_5_1_1.npy', '955_6_1.npy', '383_4_1.npy', '1395_2_1_1.npy', '1166_200_1.npy', '1145_10_1_1.npy', '768_8_1_1.npy', '806_200_1.npy', '892_5_1.npy', '917_10_1_1.npy', '1833_2_1_1.npy', '1931_5_1_1.npy', '691_10_1.npy', '869_3_1_1.npy', '295_700_1_1.npy', '1438_2_1_1.npy', '1106_10_1_1.npy', '1708_4_1_1.npy', '1199_200_1.npy', '1302_10_1_1.npy', '310_5_1_1.npy', '873_2_1_1.npy', '1054_2_1.npy', '1192_200_1.npy', '1725_11_1_1.npy', '760_2_1.npy', '818_200_1.npy', '1075_200_1.npy', '277_2_1.npy', '284_2_1.npy', '230_8_1.npy', '945_8_1_1.npy', '535_200_1_1.npy', '597_5_1_1.npy', '1193_200_1.npy', '126_10_1_1.npy', '782_8_1.npy', '1079_9_1.npy', '1491_8_1_1.npy', '1174_8_1_1.npy', '872_204_1.npy', '1710_7_1_1.npy', '326_2_1_1.npy', '190_2_1_1.npy', '844_3_1_1.npy', '1664_2_1_1.npy', '605_200_1.npy', '1984_5_1_1.npy', '917_2_1_1.npy', '533_3_1_1.npy', '1740_10_1_1.npy', '1658_8_1_1.npy', '1433_3_1_1.npy', '1197_200_1_1.npy', '1351_8_1_1.npy', '161_12_1_1.npy', '889_9_1.npy', '1032_10_1.npy', '1198_7_1.npy', '1171_10_1_1.npy', '783_4_1.npy', '660_200_1_1.npy', '904_5_1_1.npy', '602_9_1.npy', '1041_8_1.npy', '123_201_1.npy', '932_9_1.npy', '659_6_1.npy', '824_12_1.npy', '1858_3_1_1.npy', '1116_200_1_1.npy', '1470_10_1_1.npy', '1128_4_1_1.npy', '94_9_1_1.npy', '1456_8_1_1.npy', '1702_202_1_1.npy', '1209_200_1.npy', '1103_2_1_1.npy', '629_7_1_1.npy', '1971_10_1_1.npy', '974_4_1.npy', '1295_8_1.npy', '1816_2_1_1.npy', '316_2_1_1.npy', '1019_6_1_1.npy', '73_5_1_1.npy', '849_200_1_1.npy', '1276_5_1_1.npy', '380_200_1_1.npy', '817_8_1.npy', '44_2_1.npy', '262_2_1.npy', '560_2_1.npy', '1595_10_1_1.npy', '893_10_1_1.npy', '1031_10_1_1.npy', '184_200_1.npy', '1210_3_1.npy', '712_2_1_1.npy', '605_200_1_1.npy', '1112_5_1_1.npy', '158_10_1.npy', '1073_102_1_1.npy', '12_200_1.npy', '40_10_1.npy', '1043_10_1_1.npy', '1792_10_1_1.npy', '586_10_1_1.npy', '418_603_1_1.npy', '984_10_1_1.npy', '906_201_1.npy', '689_10_1_1.npy', '515_200_1.npy', '1106_5_1.npy', '116_10_1_1.npy', '825_2_1_1.npy', '59_200_1.npy', '1993_203_1_1.npy', '779_10_1_1.npy', '1115_10_1.npy', '937_3_1.npy', '32_6_1.npy', '1148_5_1_1.npy', '146_3_1_1.npy', '453_2_1.npy', '1337_200_1_1.npy', '1030_2_1_1.npy', '668_10_1_1.npy', '550_8_1.npy', '491_7_1.npy', '1556_7_1_1.npy', '329_200_1_1.npy', '1471_4_1_1.npy', '449_2_1.npy', '847_2_1_1.npy', '1940_2_1_1.npy', '489_200_1.npy', '1172_3_1.npy', '528_200_1.npy', '384_10_1_1.npy', '619_10_1_1.npy', '665_4_1.npy', '1611_2_1_1.npy', '1663_200_1_1.npy', '808_3_1_1.npy', '1267_10_1.npy', '450_10_1_1.npy', '956_3_1.npy', '1109_250_1.npy', '645_9_1_1.npy', '56_2_1_1.npy', '130_3_1_1.npy', '1969_10_1_1.npy', '316_8_1.npy', '771_2_1_1.npy', '831_5_1_1.npy', '877_200_1.npy', '497_10_1_1.npy', '373_3_1.npy', '1793_202_1_1.npy', '1379_9_1_1.npy', '814_4_1.npy', '1054_7_1_1.npy', '901_200_1.npy', '1107_10_1.npy', '1859_10_1_1.npy', '0_2_1_1.npy', '647_202_1.npy', '1778_2_1_1.npy', '1885_10_1_1.npy', '1305_200_1.npy', '47_2_1.npy', '1166_201_1.npy', '1515_2_1_1.npy', '557_2_1.npy', '89_5_1_1.npy', '552_9_1_1.npy', '70_8_1_1.npy', '1409_2_1_1.npy', '583_6_1_1.npy', '1174_2_1.npy', '1586_8_1_1.npy', '1784_200_1_1.npy', '679_10_1_1.npy', '1102_11_1.npy', '584_12_1_1.npy', '221_10_1.npy', '659_502_1.npy', '471_5_1_1.npy', '1448_200_1_1.npy', '1754_3_1_1.npy', '1843_8_1_1.npy', '1817_7_1_1.npy', '1064_5_1_1.npy', '1548_3_1_1.npy', '1764_6_1_1.npy', '1660_200_1_1.npy', '1831_10_1_1.npy', '1131_10_1_1.npy', '1493_5_1_1.npy', '1791_2_1_1.npy', '98_7_1_1.npy', '647_10_1_1.npy', '573_200_1_1.npy', '721_9_1.npy', '1966_10_1_1.npy', '1820_3_1_1.npy', '411_10_1_1.npy', '1479_102_1_1.npy', '713_7_1.npy', '1252_2_1.npy', '1069_7_1.npy', '1313_10_1_1.npy', '841_10_1.npy', '587_10_1_1.npy', '1572_10_1_1.npy', '1417_10_1_1.npy', '276_12_1.npy', '1090_4_1.npy', '695_8_1.npy', '1046_8_1_1.npy', '518_2_1.npy', '1637_10_1_1.npy', '1276_2_1.npy', '893_10_1.npy', '517_2_1.npy', '1702_2_1_1.npy', '717_201_1.npy', '561_10_1.npy', '637_4_1_1.npy', '1919_10_1_1.npy', '1866_6_1_1.npy', '1895_8_1_1.npy', '251_14_1.npy', '66_10_1.npy', '1705_10_1_1.npy', '1298_10_1.npy', '1501_102_1_1.npy', '799_3_1_1.npy', '194_10_1.npy', '1513_5_1_1.npy', '1220_5_1.npy', '749_8_1_1.npy', '2016_10_1_1.npy', '1657_11_1_1.npy', '956_200_1.npy', '28_10_1_1.npy', '854_8_1_1.npy', '1341_10_1_1.npy', '532_200_1.npy', '1462_3_1_1.npy', '187_7_1.npy', '1088_2_1_1.npy', '1135_3_1.npy', '958_8_1.npy', '65_10_1_1.npy', '1075_201_1_1.npy', '163_2_1_1.npy', '1390_10_1_1.npy', '383_8_1_1.npy', '1511_10_1_1.npy', '410_5_1_1.npy', '540_202_1_1.npy', '1523_4_1_1.npy', '899_2_1.npy', '258_10_1_1.npy', '1333_200_1_1.npy', '647_200_1.npy', '380_10_1.npy', '1830_2_1_1.npy', '1016_5_1.npy', '1250_7_1.npy', '188_10_1.npy', '652_10_1.npy', '199_201_1.npy', '1976_5_1_1.npy', '746_5_1_1.npy', '673_200_1_1.npy', '565_10_1.npy', '1865_10_1_1.npy', '540_2_1_1.npy', '557_11_1_1.npy', '1140_10_1.npy', '1947_200_1_1.npy', '241_2_1.npy', '1030_200_1_1.npy', '322_11_1_1.npy', '816_2_1.npy', '1063_303_1.npy', '431_8_1_1.npy', '962_2_1_1.npy', '511_5_1_1.npy', '1226_3_1.npy', '756_3_1_1.npy', '1577_4_1_1.npy', '956_2_1.npy', '154_4_1.npy', '1699_4_1_1.npy', '973_10_1_1.npy', '1902_6_1_1.npy', '1904_8_1_1.npy', '53_6_1.npy', '1675_200_1_1.npy', '1990_200_1_1.npy', '884_12_1.npy', '1371_7_1_1.npy', '985_10_1_1.npy', '1060_10_1.npy', '998_13_1_1.npy', '1811_5_1_1.npy', '824_201_1_1.npy', '97_10_1_1.npy', '603_8_1.npy', '1662_10_1_1.npy', '52_11_1_1.npy', '339_10_1_1.npy', '884_200_1_1.npy', '33_10_1.npy', '1870_5_1_1.npy', '614_6_1.npy', '232_3_1_1.npy', '309_10_1.npy', '935_10_1_1.npy', '1119_9_1.npy', '1514_2_1_1.npy', '226_8_1.npy', '1437_2_1_1.npy', '1273_200_1_1.npy', '674_9_1.npy', '444_11_1.npy', '355_200_1.npy', '304_9_1_1.npy', '1846_7_1_1.npy', '995_200_1_1.npy', '1210_2_1.npy', '638_5_1_1.npy', '1927_2_1_1.npy', '843_201_1_1.npy', '1040_10_1_1.npy', '1137_9_1.npy', '862_8_1_1.npy', '521_13_1_1.npy', '153_6_1_1.npy', '1894_10_1_1.npy', '439_200_1.npy', '1945_2_1_1.npy', '183_10_1.npy', '1065_3_1.npy', '62_2_1.npy', '211_200_1_1.npy', '127_200_1.npy', '753_10_1.npy', '1243_202_1.npy', '878_5_1_1.npy', '1014_10_1.npy', '535_2_1_1.npy', '1824_200_1_1.npy', '795_9_1.npy', '32_10_1_1.npy', '1241_201_1.npy', '1731_2_1_1.npy', '1494_3_1_1.npy', '1650_10_1_1.npy', '409_3_1.npy', '1991_4_1_1.npy', '302_201_1.npy', '11_9_1_1.npy', '257_10_1.npy', '213_10_1.npy', '386_5_1_1.npy', '838_10_1.npy', '867_2_1.npy', '1503_10_1_1.npy', '271_5_1_1.npy', '327_2_1.npy', '225_10_1_1.npy', '425_7_1_1.npy', '769_10_1.npy', '1550_9_1_1.npy', '948_2_1_1.npy', '830_8_1.npy', '2014_10_1_1.npy', '1698_3_1_1.npy', '990_9_1.npy', '123_2_1_1.npy', '832_4_1_1.npy', '1715_7_1_1.npy', '1677_10_1_1.npy', '962_10_1.npy', '1219_10_1_1.npy', '542_5_1.npy', '982_2_1.npy', '263_10_1.npy', '1131_10_1.npy', '1062_5_1.npy', '199_200_1.npy', '1230_3_1_1.npy', '678_10_1.npy', '1525_200_1_1.npy', '1977_10_1_1.npy', '1630_2_1_1.npy', '200_200_1.npy', '743_10_1_1.npy', '365_10_1.npy', '994_200_1.npy', '1004_10_1.npy', '691_200_1_1.npy', '299_2_1.npy', '164_5_1.npy', '1121_200_1.npy', '1625_200_1_1.npy', '496_2_1.npy', '1289_201_1_1.npy', '652_5_1_1.npy', '1660_2_1_1.npy', '22_10_1_1.npy', '1370_10_1_1.npy', '943_10_1_1.npy', '970_200_1.npy', '692_9_1_1.npy', '1901_7_1_1.npy', '1056_9_1.npy', '38_5_1_1.npy', '1566_10_1_1.npy', '1291_200_1_1.npy', '425_2_1.npy', '1925_7_1_1.npy', '560_2_1_1.npy', '1522_4_1_1.npy', '1962_10_1_1.npy', '1011_8_1.npy', '483_102_1_1.npy', '1504_4_1_1.npy', '1214_8_1_1.npy', '1757_2_1_1.npy', '1198_8_1.npy', '94_200_1_1.npy', '203_11_1_1.npy', '998_10_1_1.npy', '1318_200_1_1.npy', '379_3_1.npy', '1087_200_1.npy', '1915_10_1_1.npy', '1982_10_1_1.npy', '1086_7_1_1.npy', '356_10_1_1.npy', '586_200_1.npy', '378_8_1.npy', '359_10_1_1.npy', '1061_8_1_1.npy', '447_10_1_1.npy', '1044_7_1_1.npy', '292_10_1_1.npy', '307_8_1.npy', '627_200_1.npy', '399_9_1.npy', '1849_11_1_1.npy', '69_5_1.npy', '1173_4_1.npy', '1397_201_1_1.npy', '1028_10_1_1.npy', '121_10_1.npy', '687_200_1_1.npy', '1930_11_1_1.npy', '563_3_1.npy', '467_2_1.npy', '522_5_1.npy', '152_2_1.npy', '706_8_1.npy', '1093_11_1.npy', '238_2_1.npy', '584_9_1_1.npy', '355_201_1.npy', '115_10_1_1.npy', '1720_2_1_1.npy', '271_10_1.npy', '1083_8_1.npy', '592_2_1_1.npy', '922_10_1.npy', '64_8_1.npy', '398_5_1_1.npy', '231_8_1.npy', '2001_200_1_1.npy', '866_200_1_1.npy', '1149_6_1.npy', '1299_200_1.npy', '813_10_1.npy', '1469_10_1_1.npy', '1670_200_1_1.npy', '1472_3_1_1.npy', '692_5_1.npy', '1371_10_1_1.npy', '1366_200_1_1.npy', '94_6_1_1.npy', '1193_201_1.npy', '304_7_1_1.npy', '82_5_1_1.npy', '967_10_1_1.npy', '468_10_1.npy', '873_200_1.npy', '1473_10_1_1.npy', '1998_3_1_1.npy', '1662_11_1_1.npy', '993_8_1_1.npy', '606_200_1_1.npy', '302_200_1.npy', '1061_6_1.npy', '77_8_1.npy', '258_10_1.npy', '1652_3_1_1.npy', '903_10_1_1.npy', '1051_10_1.npy', '1920_10_1_1.npy', '278_200_1.npy', '1126_9_1.npy', '887_2_1_1.npy', '526_200_1.npy', '1070_4_1.npy', '161_5_1_1.npy', '1361_5_1_1.npy', '357_8_1.npy', '63_8_1_1.npy', '1517_4_1_1.npy', '275_5_1.npy', '1116_201_1_1.npy', '233_8_1_1.npy', '1146_5_1.npy', '16_8_1.npy', '1900_2_1_1.npy', '1145_5_1.npy', '1494_4_1_1.npy', '741_8_1_1.npy', '843_3_1.npy', '1641_10_1_1.npy', '67_2_1_1.npy', '1219_201_1.npy', '1005_11_1.npy', '1960_5_1_1.npy', '757_200_1_1.npy', '41_10_1_1.npy', '1935_8_1_1.npy', '1036_7_1.npy', '1575_200_1_1.npy', '527_201_1_1.npy', '208_5_1.npy', '690_200_1_1.npy', '105_200_1.npy', '771_8_1.npy', '370_5_1.npy', '89_10_1.npy', '1749_7_1_1.npy', '574_5_1.npy', '304_8_1_1.npy', '476_4_1_1.npy', '787_5_1.npy', '325_10_1_1.npy', '1285_2_1.npy', '1246_2_1_1.npy', '617_10_1.npy', '1274_2_1_1.npy', '1553_2_1_1.npy', '776_7_1.npy', '220_6_1_1.npy', '186_102_1_1.npy', '1443_10_1_1.npy', '462_2_1_1.npy', '417_2_1.npy', '1191_8_1_1.npy', '25_5_1_1.npy', '1005_5_1_1.npy', '662_10_1.npy', '909_7_1.npy', '395_200_1_1.npy', '1124_5_1.npy', '765_10_1_1.npy', '533_5_1.npy', '184_5_1.npy', '1875_2_1_1.npy', '655_14_1_1.npy', '1804_200_1_1.npy', '623_10_1.npy', '1832_10_1_1.npy', '1463_200_1_1.npy', '442_200_1_1.npy', '153_10_1.npy', '264_10_1_1.npy', '1286_2_1.npy', '1717_9_1_1.npy', '657_7_1.npy', '349_2_1.npy', '463_3_1.npy', '1057_10_1_1.npy', '1760_10_1_1.npy', '2012_200_1_1.npy', '1234_9_1_1.npy', '944_2_1_1.npy', '486_200_1.npy', '1225_2_1.npy', '1929_14_1_1.npy', '753_8_1_1.npy', '326_200_1_1.npy', '593_2_1.npy', '479_3_1.npy', '1124_10_1_1.npy', '378_10_1_1.npy', '142_200_1.npy', '1123_10_1_1.npy', '1354_2_1_1.npy', '891_5_1_1.npy', '1077_4_1.npy', '818_2_1.npy', '68_5_1_1.npy', '1560_3_1_1.npy', '1956_2_1_1.npy', '861_203_1_1.npy', '1085_10_1_1.npy', '1188_11_1.npy', '965_10_1.npy', '1034_2_1.npy', '36_2_1_1.npy', '468_9_1_1.npy', '918_5_1_1.npy', '1155_10_1_1.npy', '1806_200_1_1.npy', '314_200_1.npy', '905_5_1.npy', '640_10_1.npy', '1593_10_1_1.npy', '1122_4_1_1.npy', '566_11_1_1.npy', '1814_10_1_1.npy', '709_200_1.npy', '102_201_1.npy', '1835_8_1_1.npy', '17_9_1.npy', '1020_10_1.npy', '440_2_1.npy', '653_9_1_1.npy', '976_200_1_1.npy', '1210_10_1_1.npy', '1605_200_1_1.npy', '1980_4_1_1.npy', '942_10_1.npy', '953_2_1.npy', '881_10_1_1.npy', '454_201_1_1.npy', '278_6_1.npy', '270_200_1_1.npy', '1606_10_1_1.npy', '624_200_1_1.npy', '290_102_1.npy', '1280_200_1.npy', '1299_4_1_1.npy', '1103_2_1.npy', '60_10_1.npy', '527_5_1.npy', '1980_202_1_1.npy', '420_7_1_1.npy', '941_200_1_1.npy', '591_2_1_1.npy', '1479_2_1_1.npy', '638_8_1.npy', '306_7_1_1.npy', '1329_200_1_1.npy', '303_10_1_1.npy', '568_2_1.npy', '998_12_1_1.npy', '419_10_1_1.npy', '1964_200_1_1.npy', '397_5_1.npy', '1245_10_1.npy', '711_3_1_1.npy', '235_201_1.npy', '1800_3_1_1.npy', '1369_3_1_1.npy', '1534_10_1_1.npy', '133_200_1.npy', '391_2_1.npy', '925_200_1_1.npy', '179_201_1.npy', '1190_10_1_1.npy', '951_200_1_1.npy', '658_3_1.npy', '145_200_1.npy', '1356_200_1_1.npy', '745_8_1.npy', '757_2_1_1.npy', '1110_201_1.npy', '1293_5_1.npy', '1883_200_1_1.npy', '635_3_1_1.npy', '1868_8_1_1.npy', '697_10_1_1.npy', '1230_2_1_1.npy', '84_4_1.npy', '555_4_1_1.npy', '727_200_1.npy', '1589_5_1_1.npy', '845_2_1_1.npy', '67_10_1.npy', '589_3_1_1.npy', '137_2_1.npy', '1601_10_1_1.npy', '732_201_1_1.npy', '364_4_1_1.npy', '694_201_1_1.npy', '902_2_1_1.npy', '1301_7_1_1.npy', '567_2_1.npy', '633_2_1.npy', '1246_5_1.npy', '205_2_1_1.npy', '472_10_1_1.npy', '897_10_1_1.npy', '1435_8_1_1.npy', '883_4_1.npy', '868_10_1.npy', '138_10_1_1.npy', '318_200_1_1.npy', '1304_10_1.npy', '238_200_1.npy', '779_18_1_1.npy', '466_10_1.npy', '525_200_1_1.npy', '1030_201_1_1.npy', '1942_200_1_1.npy', '2012_303_1_1.npy', '967_107_1.npy', '1768_10_1_1.npy', '1228_10_1.npy', '482_10_1_1.npy', '812_200_1_1.npy', '74_10_1_1.npy', '776_10_1.npy', '1028_5_1.npy', '332_10_1.npy', '42_3_1_1.npy', '713_10_1.npy', '1506_4_1_1.npy', '1759_200_1_1.npy', '1056_2_1_1.npy', '1795_200_1_1.npy', '185_5_1_1.npy', '1414_10_1_1.npy', '164_4_1.npy', '503_4_1_1.npy', '975_3_1.npy', '1647_10_1_1.npy', '566_8_1_1.npy', '688_9_1_1.npy', '401_5_1_1.npy', '290_5_1.npy', '355_200_1_1.npy', '627_4_1_1.npy', '1805_7_1_1.npy', '1174_200_1.npy', '206_10_1_1.npy', '614_5_1.npy', '315_200_1_1.npy', '558_200_1_1.npy', '816_10_1_1.npy', '910_200_1_1.npy', '374_10_1.npy', '266_11_1.npy', '1937_8_1_1.npy', '208_18_1_1.npy', '550_10_1_1.npy', '214_200_1.npy', '1244_5_1.npy', '1510_200_1_1.npy', '485_2_1_1.npy', '542_11_1_1.npy', '369_3_1.npy', '1259_10_1_1.npy', '980_9_1.npy', '1081_7_1_1.npy', '247_11_1.npy', '309_7_1.npy', '490_2_1_1.npy', '787_10_1_1.npy', '1257_10_1.npy', '1696_4_1_1.npy', '1163_10_1.npy', '588_9_1_1.npy', '1973_2_1_1.npy', '755_8_1.npy', '1928_200_1_1.npy', '150_10_1_1.npy', '906_200_1.npy', '937_4_1_1.npy', '1284_10_1_1.npy', '348_13_1.npy', '14_10_1_1.npy', '336_5_1.npy', '971_10_1_1.npy', '1481_200_1_1.npy', '46_4_1_1.npy', '729_8_1.npy', '1676_200_1_1.npy', '696_2_1_1.npy', '124_201_1.npy', '1262_2_1_1.npy', '456_10_1.npy', '380_3_1_1.npy', '1682_200_1_1.npy', '481_200_1.npy', '1942_2_1_1.npy', '260_200_1_1.npy', '637_10_1.npy', '123_203_1.npy', '362_10_1.npy', '381_2_1_1.npy', '102_5_1_1.npy', '1327_5_1_1.npy', '1582_2_1_1.npy', '182_2_1_1.npy', '994_11_1_1.npy', '519_8_1.npy', '1496_200_1_1.npy', '712_2_1.npy', '883_6_1_1.npy', '819_2_1.npy', '1968_5_1_1.npy', '1575_5_1_1.npy', '1887_2_1_1.npy', '453_200_1.npy', '373_8_1_1.npy', '954_12_1_1.npy', '641_5_1_1.npy', '62_5_1_1.npy', '1164_14_1_1.npy', '1238_10_1.npy', '1205_4_1_1.npy', '709_201_1.npy', '1519_8_1_1.npy', '252_10_1_1.npy', '45_8_1.npy', '423_10_1_1.npy', '725_10_1.npy', '1878_200_1_1.npy', '1222_2_1_1.npy', '1670_201_1_1.npy', '1342_13_1_1.npy', '1190_4_1.npy', '1022_12_1_1.npy', '992_5_1_1.npy', '1162_2_1.npy', '631_7_1.npy', '1091_2_1.npy', '794_10_1.npy', '1466_12_1_1.npy', '1261_3_1.npy', '104_10_1_1.npy', '209_4_1.npy', '450_4_1.npy', '791_201_1_1.npy', '1827_3_1_1.npy', '139_3_1_1.npy', '509_2_1.npy', '84_2_1_1.npy', '22_8_1.npy', '539_7_1_1.npy', '847_9_1.npy', '861_200_1_1.npy', '1536_10_1_1.npy', '24_9_1_1.npy', '1408_200_1_1.npy', '734_200_1.npy', '460_4_1.npy', '333_13_1_1.npy', '293_3_1.npy', '1608_9_1_1.npy', '1905_2_1_1.npy', '1094_200_1.npy', '750_4_1_1.npy', '770_200_1_1.npy', '131_10_1_1.npy', '1680_10_1_1.npy', '1314_2_1_1.npy', '914_2_1.npy', '805_2_1.npy', '546_10_1.npy', '1209_201_1.npy', '201_8_1.npy', '1088_10_1.npy', '428_10_1.npy', '503_3_1_1.npy', '1554_2_1_1.npy', '1319_10_1_1.npy', '898_200_1_1.npy', '49_5_1_1.npy', '410_5_1.npy', '724_8_1_1.npy', '484_10_1_1.npy', '500_5_1.npy', '631_200_1.npy', '1060_6_1_1.npy', '488_10_1_1.npy', '1268_200_1_1.npy', '809_3_1_1.npy', '248_8_1_1.npy', '193_200_1_1.npy', '691_5_1_1.npy', '949_10_1.npy', '1394_7_1_1.npy', '926_5_1_1.npy', '597_200_1.npy', '774_10_1.npy', '1530_200_1_1.npy', '1310_4_1_1.npy', '851_15_1.npy', '1522_3_1_1.npy', '843_2_1_1.npy', '327_10_1_1.npy', '1675_201_1_1.npy', '909_3_1_1.npy', '972_10_1.npy', '891_2_1.npy', '305_11_1_1.npy', '1615_7_1_1.npy', '954_4_1.npy', '899_10_1.npy', '840_10_1_1.npy', '1147_10_1.npy', '493_2_1_1.npy', '1926_10_1_1.npy', '977_10_1.npy', '115_8_1.npy', '1212_200_1_1.npy', '455_3_1.npy', '666_102_1_1.npy', '61_10_1_1.npy', '1352_10_1_1.npy', '1168_10_1_1.npy', '916_8_1_1.npy', '1747_5_1_1.npy', '575_6_1.npy', '190_2_1.npy', '1420_3_1_1.npy', '1231_10_1.npy', '430_9_1_1.npy', '1289_200_1_1.npy', '1391_14_1_1.npy', '779_20_1_1.npy', '1064_200_1_1.npy', '249_10_1.npy', '1761_2_1_1.npy', '760_200_1.npy', '1073_200_1.npy', '1552_5_1_1.npy', '1692_2_1_1.npy', '547_9_1.npy', '1690_2_1_1.npy', '584_200_1_1.npy', '605_201_1.npy', '680_2_1.npy', '887_200_1.npy', '860_2_1.npy', '978_10_1.npy', '1017_10_1.npy', '1241_200_1.npy', '927_200_1_1.npy', '1064_200_1.npy', '587_10_1.npy', '504_8_1_1.npy', '573_2_1_1.npy', '189_200_1_1.npy', '515_6_1.npy', '704_8_1.npy', '366_1202_1_1.npy', '1042_201_1.npy', '48_11_1.npy', '85_202_1_1.npy', '1236_8_1_1.npy', '1005_7_1.npy', '502_7_1_1.npy', '936_11_1.npy', '128_5_1.npy', '943_4_1.npy', '460_10_1_1.npy', '127_10_1_1.npy', '811_7_1_1.npy', '1188_200_1_1.npy', '277_10_1_1.npy', '1965_9_1_1.npy', '1357_6_1_1.npy', '807_3_1.npy', '45_2_1_1.npy', '416_4_1.npy', '1967_4_1_1.npy', '386_8_1.npy', '1096_2_1_1.npy', '103_5_1_1.npy', '1170_10_1.npy', '1189_2_1.npy', '181_10_1_1.npy', '10_15_1_1.npy', '353_4_1_1.npy', '924_10_1_1.npy', '297_11_1.npy', '119_200_1_1.npy', '1046_10_1.npy', '1311_4_1_1.npy', '23_10_1.npy', '602_200_1_1.npy', '499_9_1.npy', '616_10_1.npy', '908_4_1.npy', '1113_5_1.npy', '113_200_1.npy', '740_9_1_1.npy', '601_2_1.npy', '312_200_1.npy', '1095_8_1.npy', '1449_7_1_1.npy', '722_10_1.npy', '998_9_1_1.npy', '813_3_1_1.npy', '781_10_1.npy', '789_10_1_1.npy', '828_10_1_1.npy', '1132_10_1.npy', '705_200_1_1.npy', '939_7_1_1.npy', '663_5_1.npy', '513_5_1.npy', '236_200_1.npy', '169_7_1.npy', '821_200_1.npy', '1482_200_1_1.npy', '1178_4_1.npy', '1090_8_1_1.npy', '407_200_1_1.npy', '1320_200_1_1.npy', '1799_11_1_1.npy', '487_5_1_1.npy', '959_200_1_1.npy', '694_200_1_1.npy', '1270_200_1.npy', '1096_3_1.npy', '1702_203_1_1.npy', '1154_10_1.npy', '986_5_1.npy', '609_11_1_1.npy', '1326_8_1_1.npy', '1013_10_1.npy', '1585_10_1_1.npy', '361_200_1_1.npy', '562_3_1.npy', '739_2_1_1.npy', '364_2_1_1.npy', '432_10_1.npy', '985_2_1.npy', '1916_8_1_1.npy', '1097_200_1_1.npy', '154_2_1_1.npy', '1684_4_1_1.npy', '779_22_1_1.npy', '262_10_1_1.npy', '1935_2_1_1.npy', '803_9_1_1.npy', '100_2_1.npy', '200_3_1.npy', '365_4_1_1.npy', '1635_2_1_1.npy', '1243_201_1.npy', '737_2_1.npy', '149_200_1.npy', '276_3_1_1.npy', '1906_3_1_1.npy', '998_8_1_1.npy', '648_10_1.npy', '876_200_1_1.npy', '654_8_1_1.npy', '611_8_1.npy', '921_8_1_1.npy', '633_4_1_1.npy', '1613_6_1_1.npy', '181_8_1.npy', '392_5_1.npy', '285_5_1.npy', '374_10_1_1.npy', '478_3_1.npy', '43_3_1.npy', '1807_10_1_1.npy', '339_11_1_1.npy', '1001_5_1_1.npy', '33_2_1_1.npy', '501_2_1.npy', '348_10_1.npy', '1293_3_1_1.npy', '796_10_1.npy', '535_9_1.npy', '551_2_1.npy', '386_200_1_1.npy', '1306_7_1_1.npy', '913_200_1_1.npy', '341_8_1_1.npy', '554_200_1_1.npy', '456_200_1_1.npy', '192_8_1_1.npy', '649_10_1.npy', '1008_200_1.npy', '1172_2_1_1.npy', '997_10_1.npy', '49_13_1_1.npy', '1286_11_1_1.npy', '950_2_1_1.npy', '1014_5_1_1.npy', '894_8_1.npy', '553_200_1.npy', '1580_8_1_1.npy', '1945_302_1_1.npy', '1461_5_1_1.npy', '1574_8_1_1.npy', '1531_200_1_1.npy', '600_10_1_1.npy', '1489_7_1_1.npy', '1616_10_1_1.npy', '1500_200_1_1.npy', '836_10_1_1.npy', '382_200_1_1.npy', '1505_2_1_1.npy', '1123_200_1.npy', '731_10_1_1.npy', '1146_10_1_1.npy', '617_7_1.npy', '973_200_1.npy', '1219_202_1.npy', '1954_200_1_1.npy', '1694_10_1_1.npy', '1109_2_1.npy', '800_200_1_1.npy', '872_200_1.npy', '147_8_1_1.npy', '544_200_1_1.npy', '826_10_1.npy', '934_2_1.npy', '610_2_1.npy', '1776_200_1_1.npy', '501_200_1_1.npy', '1643_4_1_1.npy', '216_5_1_1.npy', '222_10_1.npy', '735_11_1.npy', '851_6_1_1.npy', '503_10_1.npy', '287_5_1.npy', '241_3_1.npy', '330_3_1_1.npy', '825_10_1.npy', '26_200_1.npy', '963_10_1.npy', '168_4_1_1.npy', '1665_8_1_1.npy', '319_7_1_1.npy', '1099_13_1_1.npy', '286_13_1.npy', '823_200_1_1.npy', '720_10_1_1.npy', '367_200_1_1.npy', '375_8_1_1.npy', '436_200_1_1.npy', '173_2_1_1.npy', '999_2_1.npy', '594_4_1_1.npy', '534_6_1_1.npy', '273_6_1.npy', '96_11_1_1.npy', '1993_202_1_1.npy', '1669_4_1_1.npy', '1125_8_1.npy', '700_200_1.npy', '1798_4_1_1.npy', '1581_200_1_1.npy', '656_11_1.npy', '2003_8_1_1.npy', '1256_3_1_1.npy', '439_10_1_1.npy', '988_9_1_1.npy', '533_6_1_1.npy', '351_5_1.npy', '644_11_1.npy', '1335_8_1_1.npy', '745_10_1_1.npy', '95_2_1.npy', '509_10_1_1.npy', '1004_200_1_1.npy', '863_10_1.npy', '1353_10_1_1.npy', '248_2_1.npy', '1463_201_1_1.npy', '85_201_1_1.npy', '872_202_1.npy', '2_8_1_1.npy', '803_6_1_1.npy', '1428_201_1_1.npy', '1269_200_1_1.npy', '1634_2_1_1.npy', '1125_200_1_1.npy', '387_2_1.npy', '531_10_1_1.npy', '757_10_1.npy', '920_11_1_1.npy', '1150_8_1_1.npy', '1120_8_1_1.npy', '1075_10_1_1.npy', '37_6_1_1.npy', '1777_2_1_1.npy', '1065_11_1_1.npy', '1697_10_1_1.npy', '1730_8_1_1.npy', '533_402_1.npy', '369_201_1.npy', '476_2_1_1.npy', '889_5_1_1.npy', '610_6_1.npy', '571_4_1.npy', '585_4_1.npy', '654_200_1.npy', '421_200_1_1.npy', '1967_5_1_1.npy', '1295_200_1_1.npy', '806_11_1_1.npy', '1007_1100_1_1.npy', '998_11_1_1.npy', '1819_10_1_1.npy', '1075_200_1_1.npy', '23_4_1_1.npy', '900_3_1.npy', '1881_3_1_1.npy', '797_7_1.npy', '1239_200_1.npy', '1333_4_1_1.npy', '341_9_1.npy', '527_202_1_1.npy', '289_3_1.npy', '948_200_1.npy', '1903_200_1_1.npy', '871_5_1.npy', '1031_11_1.npy', '243_2_1_1.npy', '295_9_1_1.npy', '1063_3_1_1.npy', '1266_2_1_1.npy', '1148_8_1_1.npy', '73_5_1.npy', '1952_10_1_1.npy', '1856_5_1_1.npy', '475_201_1_1.npy', '98_200_1.npy', '76_10_1.npy', '1607_2_1_1.npy', '92_4_1.npy', '868_6_1_1.npy', '95_4_1_1.npy', '583_8_1.npy', '1521_2_1_1.npy', '683_8_1_1.npy', '360_200_1_1.npy', '291_5_1_1.npy', '1620_11_1_1.npy', '34_14_1_1.npy', '865_7_1.npy', '1993_201_1_1.npy', '1219_203_1.npy', '906_2_1_1.npy', '403_7_1_1.npy', '1850_5_1_1.npy', '121_4_1_1.npy', '1243_200_1.npy', '478_8_1_1.npy', '1588_200_1_1.npy', '446_3_1_1.npy', '1205_200_1.npy', '1219_200_1.npy', '1126_200_1_1.npy', '707_7_1_1.npy', '227_10_1.npy', '697_2_1.npy', '1100_3_1_1.npy', '244_3_1_1.npy', '60_8_1_1.npy', '898_10_1.npy', '643_10_1_1.npy', '599_10_1.npy', '731_200_1.npy', '1601_11_1_1.npy', '628_200_1_1.npy', '1529_8_1_1.npy', '968_10_1_1.npy', '1473_7_1_1.npy', '581_6_1.npy', '107_10_1_1.npy', '240_200_1.npy', '288_10_1_1.npy', '156_10_1.npy', '51_5_1.npy', '1066_200_1_1.npy', '731_201_1.npy', '548_8_1.npy', '207_200_1_1.npy', '1227_9_1_1.npy', '598_10_1_1.npy', '694_202_1_1.npy', '1232_10_1_1.npy', '245_10_1_1.npy', '483_8_1.npy', '418_602_1_1.npy', '1212_4_1_1.npy', '396_10_1_1.npy', '474_13_1.npy', '853_10_1_1.npy', '156_11_1_1.npy', '843_2_1.npy', '1932_200_1_1.npy', '913_4_1_1.npy', '236_6_1.npy', '1147_7_1_1.npy', '1692_200_1_1.npy', '741_5_1.npy', '123_200_1.npy', '1707_10_1_1.npy', '213_200_1_1.npy', '532_2_1.npy', '43_10_1_1.npy', '797_200_1_1.npy', '1024_8_1_1.npy', '1678_7_1_1.npy', '1795_2_1_1.npy', '1167_200_1_1.npy', '110_200_1.npy', '925_2_1_1.npy', '331_10_1.npy', '88_200_1_1.npy', '1318_2_1_1.npy', '1891_200_1_1.npy', '199_202_1.npy', '1213_200_1_1.npy', '987_10_1.npy', '1793_200_1_1.npy', '1551_10_1_1.npy', '249_10_1_1.npy', '975_10_1_1.npy', '733_5_1.npy', '510_2_1_1.npy', '767_10_1.npy', '608_10_1.npy', '940_9_1.npy', '843_200_1_1.npy', '888_200_1_1.npy', '1671_2_1_1.npy', '720_4_1.npy', '152_10_1.npy', '964_200_1.npy', '704_2_1.npy', '1023_2_1_1.npy', '1040_2_1.npy', '619_7_1_1.npy', '1906_2_1_1.npy', '989_8_1_1.npy', '1498_10_1_1.npy', '1948_8_1_1.npy', '1284_10_1.npy', '872_4_1_1.npy', '377_12_1_1.npy', '31_200_1.npy', '1411_10_1_1.npy', '1445_10_1_1.npy', '811_10_1_1.npy', '1055_8_1_1.npy', '34_7_1.npy', '571_5_1_1.npy', '204_4_1_1.npy', '107_10_1.npy', '508_9_1_1.npy', '684_6_1_1.npy', '312_6_1.npy', '328_10_1.npy', '1823_200_1_1.npy', '372_10_1.npy', '1719_10_1_1.npy', '944_5_1.npy', '698_10_1.npy', '1270_10_1_1.npy', '1951_10_1_1.npy', '1913_10_1_1.npy', '1360_200_1_1.npy', '1185_4_1.npy', '568_200_1_1.npy', '269_3_1_1.npy', '540_5_1.npy', '169_10_1.npy', '968_8_1.npy', '1651_10_1_1.npy', '665_503_1_1.npy', '196_8_1.npy', '1869_13_1_1.npy', '1975_2_1_1.npy', '81_14_1.npy', '1901_10_1_1.npy', '1822_2_1_1.npy', '1076_8_1_1.npy', '596_10_1.npy', '280_3_1.npy', '466_2_1_1.npy', '564_10_1_1.npy', '463_2_1_1.npy', '449_6_1_1.npy', '1176_7_1_1.npy', '66_10_1_1.npy', '420_200_1.npy', '1210_4_1.npy', '1196_2_1.npy', '762_4_1_1.npy', '1718_2_1_1.npy', '272_4_1_1.npy', '1072_5_1_1.npy', '381_2_1.npy', '1161_10_1_1.npy', '1142_10_1_1.npy', '1633_200_1_1.npy', '603_2_1_1.npy', '620_10_1.npy', '680_3_1_1.npy', '319_2_1.npy', '1736_5_1_1.npy', '758_10_1_1.npy', '717_200_1.npy', '1774_9_1_1.npy', '1460_200_1_1.npy', '791_200_1_1.npy', '103_7_1_1.npy', '625_200_1.npy', '682_8_1_1.npy', '18_9_1_1.npy', '116_2_1.npy', '897_10_1.npy', '12_201_1.npy', '52_200_1.npy', '1722_3_1_1.npy', '166_10_1.npy', '1614_10_1_1.npy', '404_8_1_1.npy', '934_5_1_1.npy', '1160_9_1.npy', '1796_8_1_1.npy', '1299_3_1.npy', '1299_2_1.npy', '781_200_1_1.npy', '912_200_1.npy', '1280_200_1_1.npy', '1889_10_1_1.npy', '838_3_1_1.npy', '379_2_1_1.npy', '635_4_1_1.npy', '1291_301_1_1.npy', '265_7_1_1.npy', '1372_2_1_1.npy', '450_3_1.npy', '1059_10_1_1.npy', '1878_201_1_1.npy', '376_200_1_1.npy', '1220_8_1_1.npy', '979_5_1_1.npy', '138_11_1.npy', '540_200_1_1.npy', '1114_10_1.npy', '802_200_1.npy', '905_5_1_1.npy', '178_4_1.npy', '1428_200_1_1.npy', '161_200_1_1.npy', '700_200_1_1.npy', '1987_8_1_1.npy', '532_7_1_1.npy', '329_201_1_1.npy', '778_200_1_1.npy', '1854_10_1_1.npy', '752_10_1.npy', '1359_10_1_1.npy', '1769_2_1_1.npy', '347_7_1.npy', '572_13_1_1.npy', '847_3_1_1.npy', '988_2_1.npy', '1013_200_1_1.npy', '576_8_1.npy', '737_10_1_1.npy', '1235_5_1_1.npy', '1537_200_1_1.npy', '452_4_1.npy', '2012_5_1_1.npy', '839_6_1.npy', '864_200_1.npy', '1957_200_1_1.npy', '103_10_1.npy', '902_8_1.npy', '268_2_1_1.npy', '525_200_1.npy', '307_8_1_1.npy', '827_2_1.npy', '1258_4_1_1.npy', '554_201_1_1.npy', '1852_10_1_1.npy', '1483_5_1_1.npy', '545_8_1.npy', '1946_4_1_1.npy', '595_9_1_1.npy', '2_10_1.npy', '896_10_1_1.npy', '294_2_1.npy', '88_2_1.npy', '1204_8_1_1.npy', '747_3_1.npy', '1111_10_1_1.npy', '677_3_1_1.npy', '1002_200_1_1.npy', '666_2_1_1.npy', '165_200_1_1.npy', '459_2_1_1.npy', '255_13_1.npy', '86_200_1_1.npy', '1993_204_1_1.npy', '818_200_1_1.npy', '143_10_1.npy', '237_200_1_1.npy', '38_10_1.npy', '1191_10_1.npy', '1209_202_1.npy', '493_200_1.npy', '1308_9_1.npy', '693_200_1_1.npy', '632_10_1.npy', '572_8_1.npy', '1841_200_1_1.npy', '1181_200_1.npy', '192_200_1.npy', '1241_5_1.npy', '1252_200_1_1.npy', '699_200_1.npy', '270_8_1.npy', '58_200_1_1.npy', '791_2_1_1.npy', '1738_5_1_1.npy', '480_10_1_1.npy', '665_200_1_1.npy', '125_10_1.npy', '1090_3_1.npy', '1478_5_1_1.npy', '142_201_1.npy', '768_8_1.npy', '929_3_1.npy', '1939_2_1_1.npy', '16_10_1_1.npy', '515_200_1_1.npy', '368_6_1.npy', '779_21_1_1.npy', '1957_102_1_1.npy', '1322_3_1_1.npy', '1617_10_1_1.npy', '1245_4_1_1.npy', '475_2_1.npy', '1941_10_1_1.npy', '986_8_1_1.npy', '397_200_1.npy', '1840_10_1_1.npy', '290_2_1.npy', '1283_200_1_1.npy', '1189_3_1_1.npy', '256_200_1_1.npy', '516_8_1_1.npy', '961_7_1.npy', '880_200_1_1.npy', '1993_200_1_1.npy', '603_200_1_1.npy', '2001_201_1_1.npy', '1032_13_1_1.npy', '235_200_1.npy', '585_3_1_1.npy', '144_4_1.npy', '1254_5_1.npy', '137_10_1_1.npy', '712_102_1_1.npy', '1047_10_1.npy', '774_200_1_1.npy', '80_3_1_1.npy', '596_200_1_1.npy', '1786_10_1_1.npy', '371_200_1_1.npy', '218_3_1.npy', '114_9_1_1.npy', '686_8_1.npy', '1844_200_1_1.npy', '1_10_1.npy', '557_10_1_1.npy', '1621_3_1_1.npy', '917_3_1.npy', '1739_5_1_1.npy', '51_200_1.npy', '30_200_1_1.npy', '300_11_1_1.npy', '346_10_1_1.npy', '931_3_1.npy', '400_5_1_1.npy', '1202_7_1.npy', '1673_2_1_1.npy', '295_1105_1_1.npy', '31_2_1.npy', '20_13_1.npy', '1306_2_1.npy', '480_3_1.npy', '355_202_1.npy', '1460_201_1_1.npy', '1447_10_1_1.npy', '1075_5_1.npy', '555_10_1.npy', '1338_10_1_1.npy', '674_2_1_1.npy', '289_200_1_1.npy', '1275_200_1.npy', '1396_2_1_1.npy', '1244_8_1_1.npy', '1871_200_1_1.npy', '727_200_1_1.npy', '1559_5_1_1.npy', '747_4_1.npy', '700_7_1_1.npy', '807_9_1_1.npy', '1826_7_1_1.npy', '1823_201_1_1.npy', '55_2_1.npy', '1032_10_1_1.npy', '1192_9_1_1.npy', '1268_2_1.npy', '1610_200_1_1.npy', '2006_200_1_1.npy', '1826_10_1_1.npy', '263_200_1_1.npy', '1911_200_1_1.npy', '1207_12_1_1.npy', '1533_6_1_1.npy', '612_15_1.npy', '1892_200_1_1.npy', '1142_10_1.npy', '831_10_1.npy', '657_200_1.npy', '981_11_1.npy', '616_2_1_1.npy', '1071_10_1_1.npy', '1990_2_1_1.npy', '1305_10_1_1.npy', '1082_3_1.npy', '814_3_1.npy', '1463_202_1_1.npy', '817_305_1_1.npy', '1010_10_1_1.npy', '110_201_1.npy', '199_204_1.npy', '1855_8_1_1.npy', '1221_2_1_1.npy', '843_4_1.npy', '938_10_1_1.npy', '673_201_1_1.npy', '1111_2_1.npy', '412_2_1_1.npy', '161_201_1_1.npy', '874_3_1_1.npy', '486_10_1_1.npy', '523_2_1.npy', '1197_10_1.npy', '739_8_1.npy', '1137_6_1_1.npy', '1886_10_1_1.npy', '1130_10_1_1.npy', '938_10_1.npy', '663_10_1_1.npy', '527_200_1_1.npy', '951_11_1.npy', '1239_6_1.npy', '1704_7_1_1.npy', '854_605_1.npy', '159_10_1_1.npy', '1202_10_1_1.npy', '1170_200_1_1.npy', '1233_4_1.npy', '1872_200_1_1.npy', '1520_10_1_1.npy', '1563_6_1_1.npy', '966_2_1_1.npy', '1598_3_1_1.npy', '998_3_1_1.npy', '1645_200_1_1.npy', '820_10_1_1.npy', '1790_11_1_1.npy', '1110_8_1_1.npy', '1813_5_1_1.npy', '1070_200_1_1.npy', '318_2_1_1.npy', '1542_200_1_1.npy', '1311_2_1_1.npy', '1303_7_1.npy', '1115_200_1_1.npy', '442_3_1_1.npy', '1421_10_1_1.npy', '1267_5_1_1.npy', '750_9_1.npy', '593_200_1.npy', '1377_2_1_1.npy', '1062_10_1_1.npy', '461_10_1_1.npy', '1291_10_1.npy', '1246_200_1_1.npy', '812_200_1.npy', '1187_10_1.npy', '1033_4_1.npy', '1700_2_1_1.npy', '286_5_1_1.npy', '1010_10_1.npy', '242_10_1_1.npy', '1250_200_1.npy', '498_2_1.npy', '1129_2_1_1.npy', '1229_10_1.npy', '41_201_1.npy', '93_200_1.npy', '187_10_1.npy', '74_10_1.npy', '872_201_1.npy', '1048_10_1_1.npy', '184_10_1_1.npy', '87_4_1.npy', '1012_8_1_1.npy', '1547_200_1_1.npy', '724_5_1.npy', '1336_10_1_1.npy', '548_10_1_1.npy', '615_200_1.npy', '820_8_1.npy', '952_2_1_1.npy', '1237_10_1.npy', '1721_4_1_1.npy', '1612_200_1_1.npy', '732_200_1_1.npy', '792_200_1.npy', '854_606_1.npy', '1587_200_1_1.npy', '482_10_1.npy', '1169_200_1.npy', '1860_2_1_1.npy', '703_5_1_1.npy', '436_2_1_1.npy', '578_6_1_1.npy', '1765_8_1_1.npy', '809_4_1.npy', '616_102_1_1.npy', '1048_2_1.npy', '322_2_1_1.npy', '1628_201_1_1.npy', '1803_10_1_1.npy', '1240_10_1.npy', '1154_11_1_1.npy', '1590_10_1_1.npy', '1263_200_1_1.npy', '855_3_1.npy', '2009_9_1_1.npy', '103_200_1_1.npy', '1411_11_1_1.npy', '1439_9_1_1.npy', '1242_200_1.npy', '416_3_1.npy', '483_2_1_1.npy', '748_9_1.npy', '1405_5_1_1.npy', '1237_11_1.npy', '779_2_1.npy', '324_9_1.npy', '932_9_1_1.npy', '570_3_1.npy', '1365_2_1_1.npy', '888_10_1.npy', '1891_2_1_1.npy', '1905_200_1_1.npy', '333_8_1.npy', '1708_8_1_1.npy', '413_8_1.npy', '278_12_1_1.npy', '132_5_1_1.npy', '1239_5_1.npy', '1000_4_1_1.npy', '1047_10_1_1.npy', '65_9_1.npy', '1345_10_1_1.npy', '1490_8_1_1.npy', '505_200_1_1.npy', '1288_2_1_1.npy', '1271_8_1_1.npy', '403_200_1.npy', '39_8_1_1.npy', '653_8_1.npy', '1289_202_1_1.npy', '1044_200_1.npy', '1714_2_1_1.npy', '791_10_1.npy', '1002_3_1.npy', '536_200_1.npy', '842_10_1_1.npy', '1810_10_1_1.npy', '1074_11_1_1.npy', '1136_8_1.npy', '1809_2_1_1.npy', '1734_8_1_1.npy', '661_8_1_1.npy', '901_200_1_1.npy', '1303_4_1_1.npy', '1017_10_1_1.npy', '549_2_1_1.npy', '367_200_1.npy', '467_8_1.npy', '1247_8_1_1.npy', '218_200_1.npy', '843_5_1.npy', '1296_10_1_1.npy', '358_5_1.npy', '773_200_1.npy', '369_200_1.npy', '1755_200_1_1.npy', '1452_5_1_1.npy', '1237_19_1_1.npy', '1427_10_1_1.npy', '544_200_1.npy', '723_2_1_1.npy', '1957_2_1_1.npy', '1102_12_1.npy', '1181_10_1_1.npy', '562_200_1.npy', '1152_10_1_1.npy', '683_10_1.npy', '1076_200_1.npy', '1798_8_1_1.npy', '707_10_1_1.npy', '649_10_1_1.npy', '795_8_1_1.npy', '669_3_1.npy', '772_4_1_1.npy', '1091_200_1.npy', '220_2_1.npy', '1249_200_1.npy', '1702_201_1_1.npy', '780_10_1.npy', '979_2_1.npy', '1194_10_1.npy', '1304_5_1_1.npy', '431_4_1.npy', '19_11_1.npy', '477_2_1_1.npy', '1836_9_1_1.npy', '151_8_1_1.npy', '805_13_1_1.npy', '156_10_1_1.npy', '1527_8_1_1.npy', '890_2_1_1.npy', '434_200_1_1.npy', '288_2_1.npy', '112_8_1.npy', '629_4_1.npy', '1385_4_1_1.npy', '361_201_1.npy', '1793_201_1_1.npy', '104_10_1.npy', '1388_11_1_1.npy', '543_10_1_1.npy', '710_200_1.npy', '881_8_1.npy', '605_202_1.npy', '10_10_1.npy', '1027_200_1.npy', '1553_200_1_1.npy', '786_9_1.npy', '1355_11_1_1.npy', '1105_9_1.npy', '1_5_1_1.npy', '4_10_1_1.npy', '364_11_1.npy', '203_11_1.npy', '1283_9_1.npy', '318_9_1.npy', '641_15_1.npy', '1848_8_1_1.npy', '108_7_1.npy', '1134_200_1.npy', '552_10_1.npy', '1033_2_1_1.npy', '447_10_1.npy', '1281_5_1_1.npy', '666_8_1.npy', '0_200_1.npy', '1009_3_1.npy', '732_202_1_1.npy', '1171_9_1.npy', '1153_6_1.npy', '169_2_1_1.npy', '1943_9_1_1.npy', '872_203_1.npy', '491_10_1.npy', '540_201_1_1.npy', '292_200_1.npy', '187_10_1_1.npy', '1201_10_1_1.npy', '833_2_1_1.npy', '634_5_1_1.npy', '761_601_1.npy', '1981_2_1_1.npy', '186_10_1.npy', '454_200_1_1.npy', '625_8_1_1.npy', '1117_10_1.npy', '1508_6_1_1.npy', '146_8_1.npy', '913_201_1_1.npy', '887_200_1_1.npy', '1318_201_1_1.npy', '1786_7_1_1.npy', '504_3_1.npy', '1164_2_1.npy', '859_2_1.npy', '562_201_1.npy', '1546_4_1_1.npy', '1778_200_1_1.npy', '773_5_1_1.npy', '1368_10_1_1.npy', '1107_10_1_1.npy', '728_10_1_1.npy', '1015_200_1_1.npy', '1132_10_1_1.npy', '699_10_1_1.npy', '515_5_1.npy', '128_10_1_1.npy', '860_4_1_1.npy', '164_2_1_1.npy', '1475_10_1_1.npy', '530_10_1_1.npy', '1392_2_1_1.npy', '1839_200_1_1.npy', '273_4_1.npy', '1399_8_1_1.npy', '1149_200_1.npy', '1995_4_1_1.npy', '657_10_1_1.npy', '101_10_1_1.npy', '1118_11_1.npy', '1073_2_1_1.npy', '268_3_1_1.npy', '1101_8_1.npy', '268_4_1_1.npy', '132_200_1.npy', '418_10_1.npy', '1243_8_1_1.npy', '221_8_1_1.npy', '1428_2_1_1.npy', '3_10_1.npy', '784_10_1.npy', '579_9_1_1.npy', '1075_4_1.npy', '1272_5_1_1.npy', '245_10_1.npy', '119_7_1_1.npy', '1253_9_1.npy', '1300_3_1.npy', '7_4_1_1.npy', '726_200_1.npy', '635_2_1.npy', '1348_10_1_1.npy', '168_9_1.npy', '871_200_1_1.npy', '982_200_1_1.npy', '441_8_1_1.npy', '1420_200_1_1.npy', '329_8_1.npy', '829_2_1.npy', '78_200_1.npy', '1585_7_1_1.npy', '396_2_1_1.npy', '634_10_1.npy', '1636_5_1_1.npy', '20_10_1_1.npy', '899_200_1_1.npy', '901_2_1_1.npy', '1058_2_1_1.npy', '647_201_1.npy', '939_200_1_1.npy', '1292_10_1.npy', '413_7_1.npy', '955_2_1.npy', '1224_3_1.npy', '1098_8_1_1.npy', '1282_10_1_1.npy', '21_4_1_1.npy', '342_10_1.npy', '72_2_1_1.npy', '7_200_1.npy', '1702_200_1_1.npy', '942_8_1_1.npy', '1622_8_1_1.npy', '556_2_1_1.npy', '358_8_1_1.npy', '1405_2_1_1.npy', '1753_201_1_1.npy', '1748_9_1_1.npy', '1109_200_1.npy', '961_10_1_1.npy']
	with open(num_slices_info_file, 'rb') as fp:
		num_slices_info = pickle.load(fp)

	num_slices = []
	for filename in num_slices_info:
		if filename in invalid_files_less_10_combinedNew4ChestData_lt_800:
			continue
		num_slices.append(num_slices_info[filename])

	print("avg # of slices: ", 1.0*sum(num_slices)/len(num_slices))







def visualize_wrong_preds(args, dataset):
	#_, valid_loader, _, _ = load_data(args)
	#model = model_dict[args.model](args, valid_loader.dataset.num_classes)
	#model = model.cuda()
	#model.load_state_dict(torch.load(args.model_state_dict_file))
	probs, groundtruth, csv_file_path = predict(args.model_paths, dataset, save=True)
	#print("Probs: ", probs)
	preds = (probs > 0.5).astype(int)

	with open(csv_file_path) as f:
		content = f.readlines()

	print("Num lines in {}: {}, Num lines in groundtruth: {}".format(csv_file_path, len(content), len(groundtruth)))

	label_info = {}
	filenames = [(x.strip()).split(',')[0] for x in content]
	#remove whitespace characters like `\n` at the end of each line
	labels = [int((x.strip()).split(',')[1]) for x in content]

	print("CSV Labels: ", labels)
	print("Ground tru: ", groundtruth)


	print("preds: ", len(preds))
	print("Labels: ", len(labels))
	false_positives = []
	false_negatives = []
	for index, truth in enumerate(labels):
		pred = preds[index]
		if int(truth) != int(pred[0]):
			#print("File: {} --> Ground truth: {}, Prediction: {}".format(filenames[index], truth, pred[0]))
			if int(truth) == 1:
				false_negatives.append(filenames[index])
			else:
				false_positives.append(filenames[index])



	print("False positives: ", false_positives)
	print("False negatives: ", false_negatives)


	with open("evaluate/false_positives_{}".format(dataset), "wb") as fp:
		pickle.dump(false_positives, fp)

	with open("evaluate/false_negatives_{}".format(dataset), "wb") as fp:
		pickle.dump(false_negatives, fp)
  

if __name__ == '__main__':
	view_scan('/deep/group/aihc-bootcamp-winter2018/nborus/ct_chest_pe/localized_New4ChestData/strict/HU_info_lt_-800_ut_-600_p_3.0%_ns_60/images', '999_2_1.npy')
	#data_dir ='/deep/group/aihc-bootcamp-winter2018/nborus/ct_chest_pe/localized_New4ChestData/strict/HU_info_combined_lt_-800_ut_-600_p_3.0%_ns_60'
	#data_dir = '/deep/group/aihc-bootcamp-winter2018/medical-imaging/ct_chest_pe/New4ChestData'
	#csv_file = 'valid.csv'
	#get_data_distribution(csv_file, data_dir)
	#args = get_parser().parse_args()
	#visualize_wrong_preds(args, 'valid')
	#visualize_wrong_preds(args, 'test')
	#cluster_dir = '/deep/group/aihc-bootcamp-winter2018/nborus/ct_chest_pe/New4ChestData/cluster_info/train'
	#visualize_clusters(cluster_dir, 7, 0,1000)
	#data_dir = '/deep/group/aihc-bootcamp-winter2018/medical-imaging/ct_chest_pe/New4ChestData/images/'
	#data_dir = '/deep/group/aihc-bootcamp-winter2018/nborus/ct_chest_pe/localized_New4ChestData/strict/HU_info_combined_lt_-800_ut_-600_p_3.0%_ns_60/images/'
	#csv_filepath = '/deep/group/aihc-bootcamp-winter2018/nborus/ct_chest_pe/localized_New4ChestData/strict/HU_info_combined_lt_-800_ut_-600_p_3.0%_ns_60/train.csv'
	#avg_num_slices(data_dir, csv_filepath)
	#avg_num_slices_without_outliers('/deep/group/aihc-bootcamp-winter2018/nborus/ct_chest_pe/localized_New4ChestData/strict/HU_info_combined_lt_-800_ut_-600_p_3.0%_ns_60/train_num_slices')

